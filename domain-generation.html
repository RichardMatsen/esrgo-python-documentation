<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Domain Model Code Generation (Scaffolding) | C# Interface port to Python</title>
    <meta name="description" content="C# Interface port to Python">
    
    
    <link rel="preload" href="/esrgo-python-documentation/assets/css/styles.08b8ebf7.css" as="style"><link rel="preload" href="/esrgo-python-documentation/assets/js/app.08b8ebf7.js" as="script"><link rel="preload" href="/esrgo-python-documentation/assets/js/10.fb3d3e85.js" as="script"><link rel="preload" href="/esrgo-python-documentation/assets/css/5.styles.92ce2759.css" as="style"><link rel="preload" href="/esrgo-python-documentation/assets/js/5.92ce2759.js" as="script"><link rel="prefetch" href="/esrgo-python-documentation/assets/css/1.styles.dacdc8f1.css"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/1.dacdc8f1.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/css/2.styles.6df4aee8.css"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/2.6df4aee8.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/css/3.styles.62e3bade.css"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/3.62e3bade.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/4.e0e8277f.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/6.b3d7e6cd.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/7.fcd4ff92.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/8.3d242c4d.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/9.234d134d.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/11.d1c152da.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/12.db983685.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/13.542e130d.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/14.bf07540b.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/15.123c7fb9.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/16.8c7136bb.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/17.4bf3763a.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/18.19d247d1.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/19.a9221979.js">
    <link rel="stylesheet" href="/esrgo-python-documentation/assets/css/5.styles.92ce2759.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/styles.08b8ebf7.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/1.styles.dacdc8f1.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/2.styles.6df4aee8.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/3.styles.62e3bade.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/esrgo-python-documentation/" class="home-link router-link-active"><!----> <span class="site-name">C# Interface port to Python</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/esrgo-python-documentation/" class="nav-link">Overview</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Domain Model</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/domain-generation.html" class="nav-link router-link-exact-active router-link-active">Domain Model Code Generation</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/serializing-objects.html" class="nav-link">Serializing Objects in Correct Order</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/initializing-model-classes.html" class="nav-link">Initializing Model Classes</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Processing</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/commands.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/csv-processing.html" class="nav-link">CSV Processing</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/file-handling-with-regex.html" class="nav-link">File Handling with Regex</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/logging-with-xml-serialization.html" class="nav-link">Logging with XML Serialization</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">SqlAlchemy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/extracting-data-with-sqlalchemy.html" class="nav-link">Extracting Data with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-sqlalchemy.html" class="nav-link">Query Windowing with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-a-filter-criteria.html" class="nav-link">Query Windowing with a Filter Criteria</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/esrgo-python-documentation/" class="nav-link">Overview</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Domain Model</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/domain-generation.html" class="nav-link router-link-exact-active router-link-active">Domain Model Code Generation</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/serializing-objects.html" class="nav-link">Serializing Objects in Correct Order</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/initializing-model-classes.html" class="nav-link">Initializing Model Classes</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Processing</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/commands.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/csv-processing.html" class="nav-link">CSV Processing</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/file-handling-with-regex.html" class="nav-link">File Handling with Regex</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/logging-with-xml-serialization.html" class="nav-link">Logging with XML Serialization</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">SqlAlchemy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/extracting-data-with-sqlalchemy.html" class="nav-link">Extracting Data with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-sqlalchemy.html" class="nav-link">Query Windowing with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-a-filter-criteria.html" class="nav-link">Query Windowing with a Filter Criteria</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Domain Model Code Generation (Scaffolding)</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/esrgo-python-documentation/domain-generation.html#overview" class="sidebar-link">Overview</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/esrgo-python-documentation/domain-generation.html#xml-domain-object-definitions" class="sidebar-link">XML Domain Object Definitions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/esrgo-python-documentation/domain-generation.html#domain-attributes" class="sidebar-link">Domain Attributes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/esrgo-python-documentation/domain-generation.html#conversions" class="sidebar-link">Conversions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/esrgo-python-documentation/domain-generation.html#class-builders-and-templates" class="sidebar-link">Class Builders and Templates</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/domain-generation.html#template-text-files" class="sidebar-link">Template text files</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/domain-generation.html#model-class-builder" class="sidebar-link">Model Class Builder</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/domain-generation.html#preserving-code-added-after-generation" class="sidebar-link">Preserving Code Added After Generation</a></li></ul></li><li><a href="/esrgo-python-documentation/domain-generation.html#coding-notes" class="sidebar-link">Coding Notes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/domain-generation.html#projection-of-attribute-data-to-strings" class="sidebar-link">Projection of attribute data to strings</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/domain-generation.html#using-the-‘with’-context-manager" class="sidebar-link">Using the ‘with’ context manager</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="domain-model-code-generation-scaffolding"><a href="#domain-model-code-generation-scaffolding" aria-hidden="true" class="header-anchor">#</a> Domain Model Code Generation (Scaffolding)</h1> <h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2> <p>This interface imports 12 entity types with 307 columns between then, and there are 3 areas in the application where the columns need to be defined - the model classes, the CSV parsers and the ORM table definitions. This is an opportunity to check out Python’s string handling capabilities and generate the classes from a single XML domain definition file.</p> <figure><img src="/esrgo-python-documentation/assets/img/scaffold.03775d89.png" alt="scaffold"> <figcaption><i>(click to enlarge)</i></figcaption></figure> <h2 id="xml-domain-object-definitions"><a href="#xml-domain-object-definitions" aria-hidden="true" class="header-anchor">#</a> XML Domain Object Definitions</h2> <p>The XML schema for describing domain objects is a simple list of columns with XML attributes added as required to support the generated classes.</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Address</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Columns</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Integer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PersonId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Integer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>EffectiveDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Date<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bot<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>EffectiveEndDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Date<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>eot<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Boolean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>AddressLine1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>7<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>AddressLine2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>AddressLine3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>9<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>City<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>StateProvince<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>11<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PostalCode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Country<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>13<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Column</span> <span class="token attr-name">Name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ModifiedDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>DateTime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">CsvOrdinal</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>14<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bot_datetime<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Columns</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Address</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="domain-attributes"><a href="#domain-attributes" aria-hidden="true" class="header-anchor">#</a> Domain Attributes</h2> <p>Aside from the Name, Type, CsvOrdinal and Default attributes shown above, other attributes used are:</p> <ul><li><p>ExpectedValues - gives a list of enumerated types used in CSV parser validation.</p></li> <li><p>CompositeColumn - some of the CSV columns contain sub-values which should be flattened out during loading. The CompositeColumn element contains nested column definitions.</p></li></ul> <h2 id="conversions"><a href="#conversions" aria-hidden="true" class="header-anchor">#</a> Conversions</h2> <p>As all CSV data is text, conversions are needed for other types. The expected formats are encapsulated in conversion functions rather than explicitly in the CSV parsers.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot; Conversion functions for CSV string values &quot;&quot;&quot;</span>

<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> decimal <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">to_date</span><span class="token punctuation">(</span>date_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>date_string<span class="token punctuation">,</span> <span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">to_datetime</span><span class="token punctuation">(</span>date_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>date_string<span class="token punctuation">,</span> <span class="token string">'%Y%m%d %H%M%S'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">to_int</span><span class="token punctuation">(</span>int_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> int_string <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
        int_string <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span>
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>int_string<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">to_decimal</span><span class="token punctuation">(</span>dec_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> dec_string <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
        dec_string <span class="token operator">=</span> <span class="token string">&quot;0.0&quot;</span>
    <span class="token keyword">return</span> Decimal<span class="token punctuation">(</span>dec_string<span class="token punctuation">)</span><span class="token punctuation">.</span>quantize<span class="token punctuation">(</span>Decimal<span class="token punctuation">(</span><span class="token string">'.01'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rounding<span class="token operator">=</span>ROUND_HALF_EVEN<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">BoolException</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">to_bool</span><span class="token punctuation">(</span>bool_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> bool_string<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'Yes'</span><span class="token punctuation">,</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token string">'True'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">if</span> bool_string<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">'No'</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token string">'False'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">raise</span> BoolException
</code></pre></div><p>Special date constants are used to eliminate nulls for the temporal keys EffectiveDate and EffectiveEndDate:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> date<span class="token punctuation">,</span> datetime

bot <span class="token operator">=</span> date<span class="token punctuation">(</span><span class="token number">1900</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
eot <span class="token operator">=</span> date<span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span>
bot_datetime <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">1900</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
eot_datetime <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="class-builders-and-templates"><a href="#class-builders-and-templates" aria-hidden="true" class="header-anchor">#</a> Class Builders and Templates</h2> <p>There is a Builder for each of the three types of classes to be generated. The builders take a template file for the class and substitute placeholders with specific text from the XML definition. There are just two types of substitution: the class name, and the list of attributes / columns.</p> <h3 id="template-text-files"><a href="#template-text-files" aria-hidden="true" class="header-anchor">#</a> Template text files</h3> <p><strong>ModelTemplate.txt - substitution points are <code>{0}</code> &amp; <code>{1}</code></strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> Utility<span class="token punctuation">.</span>date_constants <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Utility<span class="token punctuation">.</span>classtools <span class="token keyword">import</span> AttrDisplay

<span class="token keyword">class</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">(</span>AttrDisplay<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot; Definition of the {0} record type in EsrGo data files &quot;&quot;&quot;</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
      self<span class="token punctuation">.</span>Id <span class="token operator">=</span> <span class="token number">0</span>
      self<span class="token punctuation">.</span>EffectiveDate <span class="token operator">=</span> bot
      self<span class="token punctuation">.</span>EffectiveEndDate <span class="token operator">=</span> eot
      <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
      self<span class="token punctuation">.</span>StateValue <span class="token operator">=</span> <span class="token number">0</span>
      self<span class="token punctuation">.</span>TransportLineNo <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">for</span> key <span class="token keyword">in</span> kwargs<span class="token punctuation">:</span>
          <span class="token builtin">setattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> kwargs<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">keys</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> self<span class="token punctuation">.</span>EffectiveDate<span class="token punctuation">]</span>
</code></pre></div><p><strong>ParserTemplate.txt - substitution points are <code>{0}</code> &amp; <code>{1}</code></strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>Parser<span class="token punctuation">(</span>ParserBase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>Parser<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>metadata <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>set_helpers<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">make_instance</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>TableTemplate.txt - substitution points are <code>{0}</code> &amp; <code>{1}</code></strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> Table<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> DateTime<span class="token punctuation">,</span> Unicode<span class="token punctuation">,</span> Numeric

<span class="token keyword">def</span> make_<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>_table<span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Table<span class="token punctuation">(</span><span class="token string">'{0}'</span><span class="token punctuation">,</span> 
      metadata<span class="token punctuation">,</span>
      Column<span class="token punctuation">(</span><span class="token string">'Id'</span><span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      Column<span class="token punctuation">(</span><span class="token string">'EffectiveDate'</span><span class="token punctuation">,</span> DateTime<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      Column<span class="token punctuation">(</span><span class="token string">'EffectiveEndDate'</span><span class="token punctuation">,</span> DateTime<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
      Column<span class="token punctuation">(</span><span class="token string">'StateValue'</span><span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      Column<span class="token punctuation">(</span><span class="token string">'TransportLineNo'</span><span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
</code></pre></div><h3 id="model-class-builder"><a href="#model-class-builder" aria-hidden="true" class="header-anchor">#</a> Model Class Builder</h3> <p><strong>model_factory.py</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> Utility<span class="token punctuation">.</span>underscored_name_from_camel_case <span class="token keyword">import</span> camel_to_underscore
tab <span class="token operator">=</span> <span class="token string">' '</span> <span class="token operator">*</span> <span class="token number">4</span>

<span class="token keyword">class</span> <span class="token class-name">ModelFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> template_path<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>template_path <span class="token operator">=</span> template_path
        self<span class="token punctuation">.</span>output_path <span class="token operator">=</span> output_path
        self<span class="token punctuation">.</span>class_text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">process</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>create_model_class<span class="token punctuation">(</span>class_name<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>write_model_class<span class="token punctuation">(</span>class_name<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create_model_class</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> metadata<span class="token punctuation">)</span><span class="token punctuation">:</span>
        column_expressions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;self.{0} = {1}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token operator">*</span>attribute<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                              <span class="token keyword">for</span> attribute <span class="token keyword">in</span> metadata
                              <span class="token keyword">if</span> attribute<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">not</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token string">&quot;Id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EffectiveDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EffectiveEndDate&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
        column_expressions_string <span class="token operator">=</span> <span class="token string">&quot;\n{0}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tab <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>column_expressions<span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>template_path<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            template <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>class_text <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>class_name<span class="token punctuation">,</span> column_expressions_string<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">write_model_class</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> class_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_name <span class="token operator">=</span> camel_to_underscore<span class="token punctuation">(</span>class_name<span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>output_path<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'wt'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>class_text<span class="token punctuation">)</span>
</code></pre></div><h3 id="preserving-code-added-after-generation"><a href="#preserving-code-added-after-generation" aria-hidden="true" class="header-anchor">#</a> Preserving Code Added After Generation</h3> <p>To allow code to be added to the class after code generation (similar to c# partial classes), the template has some marker text:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#---------------------------------------------</span>
<span class="token comment"># Non-generated code below here</span>
<span class="token comment">#---------------------------------------------</span>
</code></pre></div><p>Any code lines added below this marker will be preserved during subsequent scaffolding runs.</p> <h2 id="coding-notes"><a href="#coding-notes" aria-hidden="true" class="header-anchor">#</a> Coding Notes</h2> <h3 id="projection-of-attribute-data-to-strings"><a href="#projection-of-attribute-data-to-strings" aria-hidden="true" class="header-anchor">#</a> Projection of attribute data to strings</h3> <p>The line above that converts the list of attributes to a list of strings illustrates the use of a Python list comprehension in the same way we would use a Linq expression in C#.</p> <p><strong>Python List Comprehension</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>column_expressions <span class="token operator">=</span>
  <span class="token punctuation">[</span><span class="token string">&quot;self.{0} = {1}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token operator">*</span>attribute<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token keyword">for</span> attribute <span class="token keyword">in</span> metadata
   <span class="token keyword">if</span> attribute<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">not</span> <span class="token keyword">in</span>
     <span class="token punctuation">{</span><span class="token string">&quot;Id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EffectiveDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EffectiveEndDate&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><p><strong>C# Linq Statement</strong></p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">var</span> column_expressions <span class="token operator">=</span>
  <span class="token keyword">from</span> attribute <span class="token keyword">in</span> metadata
  <span class="token keyword">where</span> <span class="token operator">!</span>excludeColumns<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>attribute<span class="token punctuation">.</span>Item1<span class="token punctuation">)</span>
  <span class="token keyword">select</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">&quot;self.{0} = {1}&quot;</span><span class="token punctuation">,</span>
    attribute<span class="token punctuation">.</span>Item1<span class="token punctuation">,</span> attribute<span class="token punctuation">.</span>Item2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="using-the-‘with’-context-manager"><a href="#using-the-‘with’-context-manager" aria-hidden="true" class="header-anchor">#</a> Using the ‘with’ context manager</h3> <p>The use of the with statement to open a file is an example of the context manager pattern in Python. It’s similar to a using() statement in C#, which automatically calls Dispose on IDisposable objects. In Python, there are no Interface definitions, so context managers follow a convention and implement <strong>enter</strong> and <strong>exit</strong> methods, which are called before and after the with statement.</p> <div class="minimap-container" style="width:250px;" data-v-5674b532><div class="minimap" style="top:250px;zoom:25%;" data-v-5674b532><div data-v-5674b532></div></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/esrgo-python-documentation/assets/js/10.fb3d3e85.js" defer></script><script src="/esrgo-python-documentation/assets/js/5.92ce2759.js" defer></script><script src="/esrgo-python-documentation/assets/js/app.08b8ebf7.js" defer></script>
  </body>
</html>
