<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>A C# Interface Application Port to Python | C# Interface port to Python</title>
    <meta name="description" content="C# Interface port to Python">
    
    
    <link rel="preload" href="/esrgo-python-documentation/assets/css/styles.08b8ebf7.css" as="style"><link rel="preload" href="/esrgo-python-documentation/assets/js/app.08b8ebf7.js" as="script"><link rel="preload" href="/esrgo-python-documentation/assets/js/7.fcd4ff92.js" as="script"><link rel="preload" href="/esrgo-python-documentation/assets/css/3.styles.62e3bade.css" as="style"><link rel="preload" href="/esrgo-python-documentation/assets/js/3.62e3bade.js" as="script"><link rel="preload" href="/esrgo-python-documentation/assets/css/5.styles.92ce2759.css" as="style"><link rel="preload" href="/esrgo-python-documentation/assets/js/5.92ce2759.js" as="script"><link rel="prefetch" href="/esrgo-python-documentation/assets/css/1.styles.dacdc8f1.css"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/1.dacdc8f1.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/css/2.styles.6df4aee8.css"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/2.6df4aee8.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/4.e0e8277f.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/6.b3d7e6cd.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/8.3d242c4d.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/9.234d134d.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/10.fb3d3e85.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/11.d1c152da.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/12.db983685.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/13.542e130d.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/14.bf07540b.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/15.123c7fb9.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/16.8c7136bb.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/17.4bf3763a.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/18.19d247d1.js"><link rel="prefetch" href="/esrgo-python-documentation/assets/js/19.a9221979.js">
    <link rel="stylesheet" href="/esrgo-python-documentation/assets/css/5.styles.92ce2759.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/styles.08b8ebf7.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/1.styles.dacdc8f1.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/2.styles.6df4aee8.css"><link rel="stylesheet" href="/esrgo-python-documentation/assets/css/3.styles.62e3bade.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/esrgo-python-documentation/" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">C# Interface port to Python</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/esrgo-python-documentation/" class="nav-link router-link-exact-active router-link-active">Overview</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Domain Model</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/domain-generation.html" class="nav-link">Domain Model Code Generation</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/serializing-objects.html" class="nav-link">Serializing Objects in Correct Order</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/initializing-model-classes.html" class="nav-link">Initializing Model Classes</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Processing</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/commands.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/csv-processing.html" class="nav-link">CSV Processing</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/file-handling-with-regex.html" class="nav-link">File Handling with Regex</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/logging-with-xml-serialization.html" class="nav-link">Logging with XML Serialization</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">SqlAlchemy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/extracting-data-with-sqlalchemy.html" class="nav-link">Extracting Data with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-sqlalchemy.html" class="nav-link">Query Windowing with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-a-filter-criteria.html" class="nav-link">Query Windowing with a Filter Criteria</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/esrgo-python-documentation/" class="nav-link router-link-exact-active router-link-active">Overview</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Domain Model</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/domain-generation.html" class="nav-link">Domain Model Code Generation</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/serializing-objects.html" class="nav-link">Serializing Objects in Correct Order</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/initializing-model-classes.html" class="nav-link">Initializing Model Classes</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Processing</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/commands.html" class="nav-link">Commands</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/csv-processing.html" class="nav-link">CSV Processing</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/file-handling-with-regex.html" class="nav-link">File Handling with Regex</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/logging-with-xml-serialization.html" class="nav-link">Logging with XML Serialization</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">SqlAlchemy</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/extracting-data-with-sqlalchemy.html" class="nav-link">Extracting Data with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-sqlalchemy.html" class="nav-link">Query Windowing with SqlAlchemy ORM</a></li><li class="dropdown-item"><!----> <a href="/esrgo-python-documentation/query-windowing-with-a-filter-criteria.html" class="nav-link">Query Windowing with a Filter Criteria</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>A C# Interface Application Port to Python</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/esrgo-python-documentation/#overview" class="sidebar-link">Overview</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/esrgo-python-documentation/#sections" class="sidebar-link">Sections</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/#domain-model" class="sidebar-link">Domain Model</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/#application-structure" class="sidebar-link">Application Structure</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/#process" class="sidebar-link">Process</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/#database" class="sidebar-link">Database</a></li><li class="sidebar-sub-header"><a href="/esrgo-python-documentation/#testing" class="sidebar-link">Testing</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="a-c-interface-application-port-to-python"><a href="#a-c-interface-application-port-to-python" aria-hidden="true" class="header-anchor">#</a> A C# Interface Application Port to Python</h1> <h2 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h2> <p>This project is a port of the C# EsrGo Interface application to Python. The goal is to explore the Python programming language and environment, using a real-world application to provide challenges.</p> <p>The aspects I’m interested in are:</p> <ul><li><p>IDE tools, specifically PyCharm from JetBrains</p></li> <li><p>Structural programming patterns and paradigms such as Commands, Events, DCI</p></li> <li><p>Database programming with a Python ORM</p></li> <li><p>Pipeline processing of large CSV file</p></li> <li><p>Error handling in the pipeline architecture</p></li> <li><p>Strategy pattern for parsing a mixed-record CSV file</p></li> <li><p>Code generation from XML definitions</p></li></ul> <h2 id="sections"><a href="#sections" aria-hidden="true" class="header-anchor">#</a> Sections</h2> <h3 id="domain-model"><a href="#domain-model" aria-hidden="true" class="header-anchor">#</a> Domain Model</h3> <ul><li><p>Using Code Generation (Scaffolding) to Manage the Domain
I was first introduced to domain code generation in the HealthRoster project. The idea is appealing when dealing with large domains, especially if the domain changes at regular intervals. This presents an opportunity to try out Python string handling and list comprehension.</p></li> <li><p>Serializing Objects to XML and Json in a Consistent Order
Serialization of objects is useful in many places, but Python suffers from “random” ordering because object attributes are stored in a dictionary. This section explores several of Pythons metaprogramming techniques to resolve this.</p></li> <li><p>Initializing Domain Entities from *args
Various parts of the application require model entities to be initialised from a Dictionary or KeyedTuple. This section looks at handling *args and **kwargs to do this.</p></li></ul> <h3 id="application-structure"><a href="#application-structure" aria-hidden="true" class="header-anchor">#</a> Application Structure</h3> <ul><li><p>Commands
Commands are classes which perform (or orchestrate) the functions of the application. They will typically correspond to the use-cases of the system, so they are useful as a focal point for understanding the code.</p></li> <li><p>Events</p></li></ul> <h3 id="process"><a href="#process" aria-hidden="true" class="header-anchor">#</a> Process</h3> <ul><li><p>CSV Processing via Data Streaming
The CSV processor is a component that takes a file of text and returns a stream of entities. Streaming is the key to handling large files, and even for smaller files it’s useful if there are a lot of steps.</p></li> <li><p>File Handling Protocol with Regex
The naming convention of the CSV files encodes a protocol for managing the transfer of these files. Regex is a good way to convert the filename string into a strong type, which makes it easier to apply the control logic. This component uses regex named groups and python list comprehension to transform the file names to objects, and lambda expressions to reduce code repetition.</p></li> <li><p>Structured Logging with XML Serialization
This application logs process info to XML, so there is a little more structure than a flat text file provides.</p> <p>Python features used include the Context Manager protocol to ensure the log is written even if the process fails, and a Decorator to make the code less invasive.</p> <p>Structured data of any arbitrary complexity can be output by using a recursive function which can emit any depth of nested objects. Within this function the standard library xml.etree is used. Individual objects control their own XML representation via a <strong>xml</strong> attribute (or all properties if none specified).</p></li></ul> <h3 id="database"><a href="#database" aria-hidden="true" class="header-anchor">#</a> Database</h3> <ul><li><p>Extracting Data with SqlAlchemy
The SqlAlchemy library for accessing SQL databases is fairly straight forward to implement, although there are some things to watch out for. This document is a run-through for two queries involving inner and outer table joins, column restriction, and a self-joined table.</p></li> <li><p>Query Window paging with SqlAlchemy
The QueryWindow object enhances SqlAlchemy queries by allowing the results to be paged. This uses the SqlAlchemy aggregate function over() to find page boundaries, then applies the filter() function on the original query to produce subsets of the results.</p></li> <li><p>Query Windowing with a Filter criteria
This answers a question on groups.google.com about use of query windows with a pre-filtered base query, as opposed to querying against the whole table.</p></li></ul> <h3 id="testing"><a href="#testing" aria-hidden="true" class="header-anchor">#</a> Testing</h3> <ul><li>BDD and TDD Testing, Profiling and Debugging</li></ul> <div></div> <div class="minimap-container" style="width:250px;" data-v-5674b532><div class="minimap" style="top:250px;zoom:25%;" data-v-5674b532><div data-v-5674b532></div></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/esrgo-python-documentation/assets/js/7.fcd4ff92.js" defer></script><script src="/esrgo-python-documentation/assets/js/3.62e3bade.js" defer></script><script src="/esrgo-python-documentation/assets/js/5.92ce2759.js" defer></script><script src="/esrgo-python-documentation/assets/js/app.08b8ebf7.js" defer></script>
  </body>
</html>
